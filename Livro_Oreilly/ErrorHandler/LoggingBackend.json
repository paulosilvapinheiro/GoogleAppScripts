{"files":[{"id":"19569992-8c9a-4e64-8a2d-11d722787b3b","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"MYSELF\"\n  }\n}"},{"id":"ca4beee3-dd4e-415b-9cb9-97fb7ca2bb71","name":"CÃ³digo","type":"server_js","source":"function doGet() {\n  \n  try{\n\n    var html \u003d HtmlService.createTemplateFromFile(\u0027index\u0027).evaluate()\n    .setTitle(\u0027Web App - Error Handler\u0027).setSandboxMode(HtmlService.SandboxMode.NATIVE);\n\n    var x \u003d t;\n\n  }catch(e){\n\n    // html.setContent(\u0027\u003ch1\u003e Ops alguma coisa deu errada !!!\u003c/h1\u003e\u0027\n    //                   + \u0027\u003cspan\u003e \u003cp\u003e\u003cb\u003eO erro foi aqui:\u003c/b\u003e\u003c/p\u003e \u003cspan\u003e\u003cbr\u003e\u0027\n    //                   + e.stack);\n\n    logErrors(e);\n  }\n  \n  return html;\n}\n\nfunction logErrors(e){\n\n    var errorSheet \u003d SpreadsheetApp.openById(\u00271tI4Woyc-wiCb0OV6YljIbAHqfsmCCJzXbEj-Nm0chSk\u0027)\n      .getSheetByName(\u0027erros\u0027);\n\n    var cell \u003d errorSheet.getRange(\u0027A1\u0027).offset(errorSheet.getLastRow(),0);\n    cell.setValue(new Date() + \" function doGet: \" + e);\n}"},{"id":"b03b4b35-78a8-4028-b0aa-9b9fdfe9b2a0","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003cscript\u003e\n      try{\n        hiUser(\"Welcome guest!\");\n      }catch(e){\n\n        google.script.run.logErrors(e.toString());\n\n      }\n    \u003c/script\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    Hello Error!!!\n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}