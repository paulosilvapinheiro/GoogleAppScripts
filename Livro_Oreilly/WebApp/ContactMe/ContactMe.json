{"files":[{"id":"dbd38ad4-c9ff-470e-a529-e2a05dea4a95","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"DOMAIN\"\n  }\n}"},{"id":"8d0fd791-1581-4d0f-a9ec-780bf6549bc1","name":"CÃ³digo","type":"server_js","source":"function doGet() {\n  \n  var html \u003d HtmlService.createTemplateFromFile(\u0027index\u0027).evaluate()\n    .setTitle(\u0027Web App\u0027).setSandboxMode(HtmlService.SandboxMode.NATIVE);\n\n  return html;\n}\n\nfunction addEmail (form){\n\n  var ss \u003d SpreadsheetApp.openByUrl(\u0027https://docs.google.com/spreadsheets/d/1p7UjbZpMTE7pCewDoLZaZ16iNVy3rYlcDvPULrr1l5o/edit?pli\u003d1\u0026gid\u003d0#gid\u003d0\u0027).getSheets()[0];\n  var range \u003d ss.getRange(ss.getLastRow()+1,1,1,2);\n  var values \u003d [[new Date(),form.email]];\n  range.setValues(values);\n\n  Logger.log(form.email);\n  return form.email;\n}\n"},{"id":"d091fe99-beac-410c-a529-8e9af480cb52","name":"index","type":"html","source":"\u003cdiv id \u003d \"subscribe_form\"\u003e\n  \u003cform id \u003d \"email_subscribe\"\u003e\n    \u003cinput type\u003d\"email\" name\u003d\"email\" id\u003d\"email\" placeholder\u003d\"Enter your e-mail\"\u003e\n    \u003cinput type\u003d\"submit\" value\u003d\"Subscribe\"\u003e\n  \u003c/form\u003e\n  \u003cspan id\u003d\"thank_you\" hidden\u003d\"true\"\u003eThank you!\u003c/span\u003e\n\u003c/div\u003e\n\u003c?!\u003d HtmlService.createHtmlOutputFromFile(\u0027css\u0027).getContent(); ?\u003e\n\n\u003cscript src\u003d\"https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js\"\u003e\u003c/script\u003e\n\n\u003cscript\u003e\n\n  $(document).ready(function(){\n    $(\"#email_subscribe\").submit(function(){\n        google.script.run.withSuccessHandler(function(ret){\n            \n            $(\"#thank_you\").show(\"slow\");\n            $(\"#email_subscribe\").slideUp();\n            console.log(ret);\n\n        }).addEmail(this);//[this] \u003d\u003e is the form element\n        return false;\n    });\n  });\n\u003c/script\u003e"},{"id":"9a94db1d-8fa7-4ab2-8c1d-acf66a43d9d8","name":"css","type":"html","source":"\u003cstyle\u003e\n\n  div{\n    width:300px;\n    margin:0px auto;\n    background-color: #fff;\n    border: 1px solid #000;\n    padding:10px;\n    text-align: center;\n  }\n\n  #thank_you{\n    font-family: Verdana, sans-serif;\n    font-size:30px;\n    color:#0000ff;\n  }\n\n\u003c/style\u003e"}]}